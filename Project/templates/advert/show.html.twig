{% extends 'base.html.twig' %}

{% block title %}Advert{% endblock %}

{% block body %}
    <h1>Advert</h1>

    {% if not app.user %}

    
        <h2>Oh ...</h2>

        <div>
            <p>Sorry traveler, we need to know you a bit more to show you everything.<br>
            <a href="{{ path ('app_login') }}">Speak friend</a> or <a href="{{ path ('app_register') }}">join us</a>.</p>
        </div>
        devnote : prévoir redirection ici après connexion
    
    {% else %}

    
    <div class="card">
        <div class="card-body">
            <p class="card-text">{{ advert.author.username }} ({{ timeAgo(advert.publishDate).text }})</p>
            <p class="card-text">Level : {{ advert.level }}</p>
            <p class="card-text">Modality : 
            {% if advert.modality %}
                {{ advert.modality }}</p>
            {% else %}
                unspecified
            {% endif %}
            <p class="card-text">Around : 
            {% if advert.area %}
                {{ advert.area }}</p>
            {% else %}
                unspecified
            {% endif %}
            <p class="card-text">{{ advert.content }}</p>
        </div>
    </div>

    <div>
        <h3>Comments</h3>
        
        {% for comment in advert.comments %}

            <div id='{{ comment.id }}' class='comment'>
            <hr>
            <p>{{ comment.author.username }} ({{ timeAgo(comment.publishDate).text }})
            {% if comment.answerTo %}
                in reply to: <a href="#{{ comment.answerTo.id }}">@{{ comment.answerTo.author.username }}</a></p>
                {# trouver limite caractères #}
            {% endif %}
            <p>{{ comment.content }}</p>
            </div>
        {% endfor %}
    </div>

    <div>
        <h3>Leave a comment</h3>    {# mieux en AJAX ? #}

        {# {{ form_start(newComment) }} #}

        {# trouver comment gérer réponse à #}
        {# {{ form_widget(newComment.content) }}
        {{ form_widget(newComment._token) }}
        <input type="submit" value="Send">

        {{ form_end(newComment, {render_rest:false}) }} #}
    </div>
        



    <table class="table">
        <tbody>
            <tr>
                <th>Id</th>
                <td>{{ advert.id }}</td>
            </tr>
            <tr>
                <th>PublishDate</th>
                <td>{{ advert.publishDate ? advert.publishDate|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
            <tr>
                <th>IsOpen</th>
                <td>{{ advert.isOpen ? 'Yes' : 'No' }}</td>
            </tr>
            <tr>
                <th>Modality</th>
                <td>{{ advert.modality }}</td>
            </tr>
            <tr>
                <th>Area</th>
                <td>{{ advert.area }}</td>
            </tr>
            <tr>
                <th>Level</th>
                <td>{{ advert.level }}</td>
            </tr>
            <tr>
                <th>Content</th>
                <td>{{ advert.content }}</td>
            </tr>
        </tbody>
    </table>

    <a href="{{ path('app_advert_index') }}">back to list</a>

    <a href="{{ path('app_advert_edit', {'id': advert.id}) }}">edit</a>

    {{ include('advert/_delete_form.html.twig') }}

    {% endif %}

{% endblock %}
